<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
    <meta charset="utf-8">
    <title>ArtisticAura</title>
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:title" content="">
    <meta property="og:type" content="">
    <meta property="og:url" content="">
    <meta property="og:image" content="">
    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="assets/imgs/theme/Artisticlogo.ico">
    <link rel="stylesheet" href="assets/css/main.css?v=3.4">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick-theme.css">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/magnific-popup.min.css">



</head>

<body>
<main>
  <section class="pt-150 pb-150">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-lg-10">
          <div class="row justify-content-center">
            <div class="col-lg-5">
              <div class="login_wrap p-30 background-white border-radius-10 mb-md-5 mb-lg-0 mb-sm-5">
                                <!-- Logo Section -->
                <img src="/assets/imgs/theme/artisticAura.png" alt="ArtisticAura Logo" class="logo"style="width: 150px; height: auto; display: block; margin: 0 auto;">
                  <div class="heading_s1"style="text-align: center;">
                      <h3 class="mb-30">Login</h3>
                  </div>
                      <form method="post" action="/loginn">
                        <div class="form-group">
                           <input type="text" required="" name="email" placeholder="Your Email">
                        </div>
                        <div class="form-group">
                          <input required="" type="password" name="password" placeholder="Password">
                        </div>
                        <div class="login_footer form-group">
                         <div class="chek-form">
                          <div class="custome-checkbox">
                            <input class="form-check-input" type="checkbox" name="checkbox" id="rememberMe" value="">
                                <label class="form-check-label" for="exampleCheckbox1"><span>Remember me</span></label>
                          </div>
                          <div class="form-group">
                             <button type="submit" class="btn btn-fill-out btn-block hover-up" name="login">Log in</button>
                          </div>
                          <div class="text-muted text-center">Dont have an account?<br><a href="/register">Sign up now</a></div>
                        </div>
                      </form>
                  <div class="text-center">
                    <a href="#" data-bs-toggle="modal" data-bs-target="#forgotPasswordModal">Forgot Password?</a>
                  </div><!-- Forgot Password Modal -->
                      <div class="modal fade" id="forgotPasswordModal" tabindex="-1" aria-labelledby="forgotPasswordLabel" aria-hidden="true">
                          <div class="modal-dialog">
                            <div class="modal-content">
                              <form id="forgotPasswordForm" action="/forgotPassword" method="POST">
                                <div class="modal-header">
                                  <h5 class="modal-title" id="forgotPasswordLabel">Forgot Password</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                  <div class="mb-3">
                                    <label for="email" class="form-label">Enter your registered email</label>
                                      <input type="email" class="form-control" id="email" name="email" required>
                                  </div>
                                </div>
                               <div class="modal-footer">
                                <button type="submit" class="btn btn-primary">Send OTP</button>
                               </div>
                              </form>
                            </div>
                          </div>
                        </div>
                                                      
                        <!-- OTP Verification Modal -->
                      <div class="modal fade" id="otpModal" tabindex="-1" aria-labelledby="otpModalLabel" aria-hidden="true">
                        <div class="modal-dialog">
                          <div class="modal-content">
                            <form id="otpForm" action="/verifyOtpForPassword" method="POST">
                              <div class="modal-header">
                                <h5 class="modal-title" id="otpModalLabel">Verify OTP</h5>
                                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                              </div>
                              <div class="modal-body">
                              <div class="mb-3">
                              <label for="otp" class="form-label">Enter OTP sent to your email</label>
                              <input type="hidden" name="email" id="otpEmail">
                                <input type="text" class="form-control" id="otp" name="otp">
                                  </div>
                                  <div id="otpTimer" class="text-center"></div>
                                  </div>
                                  <div class="modal-footer">
                                    <button id="otpButton" type="submit" class="btn btn-primary">Send OTP</button>
                                  </div>
                            </form>
                          </div>
                        </div>
                      </div>
                          <!-- Reset Password Modal -->
                      <div class="modal fade" id="resetPasswordModal" tabindex="-1" aria-labelledby="resetPasswordLabel" aria-hidden="true">
                        <div class="modal-dialog">
                          <div class="modal-content">
                            <form id="resetPasswordForm" action="/resetPassword" method="POST">
                              <div class="modal-header">
                                <h5 class="modal-title" id="resetPasswordLabel">Reset Password</h5>
                                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <div class="modal-body">
                                      <input type="hidden" name="email" id="resetEmail">
                                    <div class="mb-3">
                                      <input id="newPasswordInput" class="form-control" placeholder="New Password" type="password" name="newpassword" onkeyup="validatePassword()">
                                      <span id="password-error" style="font-size: 14px; color: red;"></span>
                                    </div>
                                    <div class="mb-3">
                                      <input id="confirmPasswordInput" class="form-control" placeholder="Confirm Password" type="password" name="confirmpassword" onkeyup="validatePassword()">
                                      <span id="confirm-password-error" style="font-size: 14px; color: red;"></span>
                                    </div>
                                </div>
                              <div class="modal-footer">
                                <button type="submit" class="btn btn-primary">Reset Password</button>
                              </div>
                            </form>                            
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                                                      
                </div>
              </div>
            </div>   
          </div>
        </div>
      </div>
    </div>
  </section>
</main>
    
    <!-- Preloader Start -->
    <div id="preloader-active">
        <div class="preloader d-flex align-items-center justify-content-center">
            <div class="preloader-inner position-relative">
                <div class="text-center">
                    <h5 class="mb-5">Now Loading</h5>
                    <div class="loader">
                        <div class="bar bar1"></div>
                        <div class="bar bar2"></div>
                        <div class="bar bar3"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
     <!-- Vendor JS -->
     <script src="assets/js/vendor/modernizr-3.6.0.min.js"></script>
     <script src="assets/js/vendor/jquery-3.6.0.min.js"></script>
     <script src="assets/js/vendor/jquery-migrate-3.3.0.min.js"></script>
     <script src="https://cdnjs.cloudflare.com/ajax/libs/elevatezoom/3.0.8/jquery.elevatezoom.min.js"></script>
     <script src="assets/js/vendor/bootstrap.bundle.min.js"></script>
 
     <!-- Plugin JS -->
     <script src="assets/js/plugins/jquery-ui.js"></script>
     <script src="assets/js/plugins/slick.js"></script>
     <script src="assets/js/plugins/jquery.syotimer.min.js"></script>
     <script src="assets/js/plugins/wow.js"></script>
     <script src="assets/js/plugins/perfect-scrollbar.js"></script>
     <script src="assets/js/plugins/magnific-popup.js"></script>
     <script src="assets/js/plugins/select2.min.js"></script>
     <script src="assets/js/plugins/waypoints.js"></script>
     <script src="assets/js/plugins/counterup.js"></script>
     <script src="assets/js/plugins/jquery.countdown.min.js"></script>
     <script src="assets/js/plugins/images-loaded.js"></script>
     <script src="assets/js/plugins/isotope.js"></script>
     <script src="assets/js/plugins/scrollup.js"></script>
     <script src="assets/js/plugins/jquery.vticker-min.js"></script>
     <script src="assets/js/plugins/jquery.theia.sticky.js"></script>
 
     <!-- SweetAlert2 JS -->
     <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.all.min.js"></script>
 
     <!-- Slick Carousel JS -->
     <script src="https://cdn.jsdelivr.net/npm/slick-carousel@1.8.1/slick/slick.min.js"></script>
 
     <!-- Magnific Popup JS -->
     <script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.min.js"></script>
 
     <!-- jQuery UI JS -->
     <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
 
     <!-- Your main script -->
     <script src="./assets/js/main.js?v=3.4"></script>
     <script>
     document.addEventListener('DOMContentLoaded', function() {
      // Initialize elements
      const otpButton = document.getElementById('otpButton');
      // const resendOtpButton = document.getElementById('resendOtpButton');
      const rememberMeCheckbox = document.getElementById('rememberMe');
      const emailInput = document.querySelector('input[name="email"]');
      const forgotPasswordForm = document.getElementById('forgotPasswordForm');
      const otpForm = document.getElementById('otpForm');
      const resetPasswordForm = document.getElementById('resetPasswordForm');
    
      let otpTimer;
      let timeLeft = 60;
      let isVerifying = false;
      let resetEmailInput={};
      // Function to start OTP Timer
      function startOtpTimer() {
        timeLeft = 60;
        // otpButton.disabled = true;
        // otpButton.textContent = `Verify OTP (${timeLeft})`;
        // resendOtpButton.style.display = 'none';
    
        otpTimer = setInterval(() => {
          timeLeft--;
          otpButton.textContent = `Verify OTP (${timeLeft})`;
    
          if (timeLeft <= 0) {
            clearInterval(otpTimer);
            otpButton.disabled = false;
            otpButton.textContent = 'Resend OTP';
            // resendOtpButton.style.display = 'block';
          }
        }, 1000);
      }
    
      
      function openOtpModal(email) {
        document.getElementById('otpEmail').value = email;
        const otpModal = new bootstrap.Modal(document.getElementById('otpModal'));
        otpModal.show();
        startOtpTimer();
      }
    
     
      function openResetPasswordModal(email) {
        // let resetEmailInput = document.getElementById('resetEmail');
        resetEmailInput.value = email;

        console.log("email set:", resetEmailInput.value)
        const resetPasswordModal = new bootstrap.Modal(document.getElementById('resetPasswordModal'));
        
        resetPasswordModal.show();
      }
    
      
      forgotPasswordForm.addEventListener('submit', function(event) {
        event.preventDefault(); 
        console.log("forgotPasswordForm")
        const email = document.getElementById('email').value;
    
        fetch('/forgotPassword', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email })
        })
        .then(response => response.json())
        .then(data => {
          console.log("iam data",data)
          if (data.success) {
            Swal.fire({
              icon:'success',
              title: 'OTP Sent!',
              text: 'Please check your email for the OTP.',
              confirmButtonText: 'OK',
               confirmButtonColor: '#28a745'
            }).then(() => openOtpModal(email));
          } else {
            Swal.fire({
              icon: 'error',
              title: 'Failed',
              text: 'Failed to send OTP. Please try again.',
              confirmButtonText: 'OK',
              confirmButtonColor: '#dc3545'
            });
          }
        })
        .catch(error => {
          console.error('Error:', error);
          Swal.fire({
            icon: 'error',
            title: 'Error',
            text: 'An error occurred. Please try again later.',
            confirmButtonText: 'OK',
            confirmButtonColor: '#dc3545'
          });
        });
      });
    otpButton.addEventListener('click',function(event){
      event.preventDefault();
      console.log("iam in verification")
      if(timeLeft>0){
        const email = document.getElementById('otpEmail').value;
        const otp = document.getElementById('otp').value;
    
        fetch('/verifyOtpForPassword', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email, otp })
        })
        .then(response => response.json())
        .then(data => {
          if (data.success) {
            Swal.fire({
              icon:'success',
              title: 'OTP Verified!',
              text: 'You can now reset your password.',
              confirmButtonText: 'OK',
               confirmButtonColor: '#28a745'
            }).then(() => openResetPasswordModal(email));
          } else {
            Swal.fire({
              icon: 'error',
              title: 'Invalid OTP',
              text: data.message || 'Please enter the correct OTP and try again.',
              confirmButtonText: 'OK',
              confirmButtonColor: '#dc3545'
            });
          }
        })
        .catch(error => {
          console.error('Error:', error);
          Swal.fire({
            icon: 'error',
            title: 'Error',
            text: 'An error occurred while verifying the OTP. Please try again later.',
            confirmButtonText: 'OK',
            confirmButtonColor: '#dc3545'
          });
        });

      }else{
        console.log("resendOtpButton")
        const email = document.getElementById('otpEmail').value;
    
        fetch('/forgotPassword', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email })
        })
        .then(response => response.json())
        .then(data => {
          console.log("iam resend data")
          if (data.success) {
            Swal.fire({
              icon:'success',
              title: 'OTP Resent!',
              text: 'Please check your email for the new OTP.',
              confirmButtonText: 'OK',
               confirmButtonColor: '#28a745'
            }).then(() => startOtpTimer());
          } else {
            Swal.fire({
              icon: 'error',
              title: 'Failed',
              text: 'Failed to resend OTP. Please try again.',
              confirmButtonText: 'OK',
              confirmButtonColor: '#dc3545'
            });
          }
        })
        .catch(error => {
          console.error('Error:', error);
          Swal.fire({
            icon: 'error',
            title: 'Error',
            text: 'An error occurred. Please try again later.',
            confirmButtonText: 'OK',
            confirmButtonColor: '#dc3545'
          });
        });

      }

    })

    
    
      
    
      // resetPasswordForm.addEventListener('submit', function(event) {
      //   event.preventDefault();
      //   const email = document.getElementById('resetEmail').value;
      //   // console.log("in side reset",email)
      //   const newPassword = document.getElementById('newPassword').value;
      //   // console.log("newPassword",newPassword)
      //   const confirmPassword = document.getElementById('confirmPassword').value;
      //   // console.log("confirmPassword",confirmPassword)
      //   if (newPassword !== confirmPassword) {
      //     Swal.fire({
      //       icon: 'error',
      //       title: 'Oops...',
      //       text: 'Passwords do not match. Please try again.',
      //       confirmButtonColor: '#ffc107'
      //     });
      //     return;

    document.getElementById('newPasswordInput').addEventListener('keyup', validatePassword);
    document.getElementById('confirmPasswordInput').addEventListener('keyup', validatePassword);

    function validatePassword() {
        const newPassword = document.getElementById('newPasswordInput').value;
        const confirmPassword = document.getElementById('confirmPasswordInput').value;
        const passwordError = document.getElementById("password-error");
        const confirmPasswordError = document.getElementById("confirm-password-error");
       

        if (newPassword.includes(' ')) {
            passwordError.innerHTML = "Password should not contain spaces";
            passwordError.style.color = "red";
            return false;
        } else if (newPassword.length < 5) {
            passwordError.innerHTML = "Password must be at least 5 characters";
            passwordError.style.color = "red";
            return false;
        } else {
            passwordError.innerHTML = "Valid";
            passwordError.style.color = "green";
        }

       
        if (newPassword && confirmPassword) {
            if (newPassword !== confirmPassword) {
                confirmPasswordError.innerHTML = "New Password and Confirm Password do not match!";
                confirmPasswordError.style.color = "red";
                return false;
            } else {
                confirmPasswordError.innerHTML = "Passwords match";
                confirmPasswordError.style.color = "green";
            }
        } else {
            confirmPasswordError.innerHTML = ""; 
        }

        return true;
    }

    document.getElementById('resetPasswordForm').addEventListener('submit', async function(event) {
        event.preventDefault();

        const newPassword = document.getElementById('newPasswordInput').value;
        const confirmPassword = document.getElementById('confirmPasswordInput').value;
        const email = resetEmailInput.value;  // Get email value safely

        console.log("Email used for reset:", email);

            if (!validatePassword()) {
                    return;
                }

        const response = await fetch('/resetPassword', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email, newPassword ,confirmPassword})
        })
        .then(response => response.json())
        .then(data => {
          // console.log("iam data in match",data)
          if (data.success) {
            Swal.fire({
              icon:'success',
              title: 'Success!',
              text: data.message,
               confirmButtonColor: '#28a745'
            }).then(() => {
              window.location.href = '/login';
            });
          } else {
            Swal.fire({
              icon: 'error',
              title: 'Error!',
              text: data.message || 'Password reset failed. Please try again.',
            });
          }
        })
        .catch(error => {
          console.error('Error:', error);
          Swal.fire({
            icon: 'error',
            title: 'Error',
            text: 'An error occurred during password reset. Please try again later.',
            confirmButtonText: 'OK',
            confirmButtonColor: '#ffc107'
          });
        });}
      );
   
    
   
    // Remember Me functionality
    if (localStorage.getItem('rememberMe') === 'true') {
      emailInput.value = localStorage.getItem('email');
      rememberMeCheckbox.checked = true;
    }
    
    document.querySelector('form').addEventListener('submit', function() {
      if (rememberMeCheckbox.checked) {
        localStorage.setItem('rememberMe', 'true');
        localStorage.setItem('email', emailInput.value);
      } else {
        localStorage.removeItem('rememberMe');
        localStorage.removeItem('email');
      }
    });
  })  </script>
  <script>
      document.querySelector('form').addEventListener('submit', function(event) {
  event.preventDefault();  // Prevent form submission to handle via JavaScript

  const email = document.querySelector('input[name="email"]').value;
  const password = document.querySelector('input[name="password"]').value;

  fetch('/loginn', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ email, password })
  })
  .then(response => response.json())
  .then(data => {
    if (data.success) {
      if (data.message === "LoginSuccess") {
        window.location.href = '/';  // Redirect to homepage on successful login
      }
    } else {
      // Display SweetAlert messages based on the specific response message
      switch (data.message) {
        case "AccountBlocked":
          Swal.fire({
            icon: 'error',
            title: 'Account Blocked',
            text: 'Your account has been blocked. Please contact support.',
            confirmButtonText: 'OK',
            confirmButtonColor: '#ffc107'
          });
          break;
        case "InvalidCredentials":
          Swal.fire({
            icon: 'error',
            title: 'Login Failed',
            text: 'Invalid email or password. Please try again.',
            confirmButtonText: 'OK',
            confirmButtonColor: '#ffc107'
          });
          break;
        case "UserNotRegistered":
          Swal.fire({
            icon: 'warning',
            title: 'Not Registered',
            text: 'User not found. Please sign up to create an account.',
            confirmButtonText: 'Sign Up',
            confirmButtonColor: '#ffc107'
          }).then(() => {
            window.location.href = '/register';  // Redirect to registration page
          });
          break;
        case "ServerError":
          Swal.fire({
            icon: 'error',
            title: 'Server Error',
            text: 'An error occurred on the server. Please try again later.',
            confirmButtonText: 'OK',
            confirmButtonColor: '#ffc107'
          });
          break;
      }
    }
  })
  .catch(error => {
    console.error('Error:', error);
    Swal.fire({
      icon: 'error',
      title: 'Error',
      text: 'An error occurred. Please try again later.',
      confirmButtonText: 'OK',
      confirmButtonColor: '#ffc107'
    });
  });
});

  </script>
</body>

</html>